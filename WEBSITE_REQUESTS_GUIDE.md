# دليل طلبات المساعدة من الموقع

## نظرة عامة
تم تحديث نظام إدارة المساعدات ليدعم طلبات المساعدة المقدمة مباشرة من الموقع. الآن عندما يقوم المستخدمون بتقديم طلبات مساعدة من خلال النموذج على الموقع، ستظهر هذه الطلبات تلقائياً في:

1. **صفحة إدارة الطلبات** (`/admin-requests`) - للإدارة ولجنة الموافقات
2. **صفحة المساعدات** (`/assistances`) - لجميع الموظفين

## كيفية عمل النظام

### 1. تقديم طلب مساعدة من الموقع
- المستخدم يملأ نموذج طلب المساعدة في صفحة `/request-assistance`
- النظام يتحقق من وجود المستفيد بناءً على الرقم القومي
- إذا لم يكن المستفيد موجوداً، يتم إنشاء مستفيد جديد
- يتم إنشاء طلب مساعدة جديد بحالة "معلق"

### 2. مراجعة الطلبات
- تظهر الطلبات الجديدة في صفحة إدارة الطلبات
- يمكن للإدارة ولجنة الموافقات:
  - اعتماد الطلب (تغيير الحالة إلى "معتمد")
  - رفض الطلب (تغيير الحالة إلى "مرفوض")
  - تسجيل الدفع (تغيير الحالة إلى "مدفوع")

### 3. البيانات المضافة
تم إضافة 4 طلبات مساعدة جديدة من الموقع كأمثلة:
- طلب طبي عاجل (أميرة محمد أحمد حسن)
- مساعدة مالية للأسر المحتاجة (عبدالله سعد محمد علي)
- رسوم دراسية (نورا عبدالرحمن خالد سعد)
- كفالة أيتام (محمود أحمد علي حسن)

## الميزات الجديدة

### في صفحة طلب المساعدة:
- ✅ إضافة مستفيد جديد تلقائياً إذا لم يكن موجوداً
- ✅ إنشاء طلب مساعدة جديد بحالة "معلق"
- ✅ حفظ البيانات في التخزين المحلي
- ✅ رسائل تأكيد للمستخدم

### في صفحة إدارة الطلبات:
- ✅ عرض جميع الطلبات بما في ذلك طلبات الموقع
- ✅ إمكانية اعتماد/رفض الطلبات
- ✅ تسجيل الدفع للطلبات المعتمدة
- ✅ إحصائيات محدثة تشمل الطلبات الجديدة

## كيفية الاختبار

1. **تسجيل الدخول كمدير أو لجنة موافقات:**
   - Username: `admin` / Password: `admin123`
   - أو Username: `approver_1` / Password: `approver123`

2. **الذهاب إلى صفحة إدارة الطلبات:**
   - ستجد 4 طلبات جديدة بحالة "معلق"
   - يمكنك اعتماد أو رفض هذه الطلبات

3. **اختبار تقديم طلب جديد:**
   - تسجيل الدخول كمستفيد أو موظف
   - الذهاب إلى صفحة طلب المساعدة
   - ملء النموذج وإرساله
   - ستظهر الطلبة الجديدة في صفحة الإدارة

## ملاحظات مهمة

- جميع الطلبات الجديدة تبدأ بحالة "معلق"
- يتم حفظ البيانات في التخزين المحلي للمتصفح
- النظام يدعم إضافة مستفيدين جدد تلقائياً
- يمكن تصدير قائمة الطلبات إلى Excel

## الأذونات المطلوبة

- **لجنة الموافقات** (`approver`): يمكنها اعتماد/رفض الطلبات وتسجيل الدفع
- **الإدارة** (`admin`): يمكنها إدارة جميع الطلبات
- **مديري الفروع** (`branch_manager`): يمكنهم إدارة طلبات فرعهم
- **الموظفين** (`staff`): يمكنهم إضافة طلبات جديدة
- **المستفيدين** (`beneficiary`): يمكنهم تقديم طلبات مساعدة
